**安装SequoiaDB-PostgreSQL组件，创建PostgreSQL实例，验证与SequoiaDB数据库的连接与访问**

**首先，进入PostgreSQL组件安装包所在目录：**

cd /home/shiyanlou/sequoiadb-3.4/

**修改PostgreSQL组件安装包文件属性，获取root权限：**
sudo chmod 777 sequoiasql-postgresql-3.4-x86_64-installer.run

[sudo] sdbadmin 的密码： 

注：sdbadmin密码：sdbadmin

sudo su

**安装PostgreSQL组件：**
 ./sequoiasql-postgresql-3.4-x86_64-installer.run 

操作截图：

![图片描述](https://doc.shiyanlou.com/courses/1541/1207281/e4a2e886aed80664bb9c87d41126ab69)

**检查5432端口是否被占用,  切换回sdbadmin用户：**

netstat -nap|grep 5432

exit                      

**进入PostgreSQL组件安装目录，创建PostgreSQL实例:**

**指定实例名为myinst，该实例名映射相应的数据目录和日志路径，用户可以根据自己需要指定不同的实例名**

cd /opt/sequoiasql/postgresql/

bin/sdb_sql_ctl addinst myinst -D database/5432/

操作截图：

![图片描述](https://doc.shiyanlou.com/courses/1541/1207281/36493c6bd213e1c4ee639e1e1522ce7f)

**查看PostgreSQL实例：**

bin/sdb_sql_ctl listinst

操作截图：

![图片描述](https://doc.shiyanlou.com/courses/1541/1207281/eb3f6700aef8d54bd62cbe38b6988e1a)

**启动PostgreSQL实例：**

bin/sdb_sql_ctl start myinst

操作截图：

![图片描述](https://doc.shiyanlou.com/courses/1541/1207281/c1bc7dc290293430ea4b2acb00ae52d4)

**查看PostgreSQL实例状态：**

bin/sdb_sql_ctl status

操作截图：

![图片描述](https://doc.shiyanlou.com/courses/1541/1207281/7a30a34a2216424db49ab76cf9a5a7c4)

**建立PostgreSQL实例与SequoiaDB数据库的关联**

**首先，启动SequoiaDB数据库：**

sdbstart -t all

操作截图：

![图片描述](https://doc.shiyanlou.com/courses/1541/1207281/aba05f27dd7a21b11bf53cc06ff5ade0)

**在SequoiaDB数据库中, 创建集合空间sample和集合emp，插入样例数据：**

sdb

操作截图：

![图片描述](https://doc.shiyanlou.com/courses/1541/1207281/69a8282eeab1925bb10b566410be3e16)

db = new Sdb()

操作截图：

![图片描述](https://doc.shiyanlou.com/courses/1541/1207281/579f63e8da5645b5bc9b6f53cbad2dd2)

**创建集合空间sample和集合emp**

db.createCS("sample").createCL("emp")

操作截图：

![图片描述](https://doc.shiyanlou.com/courses/1541/1207281/6b9c24accc302ca8661a969926924bcd)

**插入样例数据:**

db.sample.emp.insert({id:1,name:"emp1"})

操作截图：

![图片描述](https://doc.shiyanlou.com/courses/1541/1207281/b60e924a67725043d075daea52292a44)
db.sample.emp.insert({id:2,name:"emp2"})

操作截图：

![图片描述](https://doc.shiyanlou.com/courses/1541/1207281/45b0befae5b9f4c33ae8cfc81483d6d0)
quit

操作截图：

![图片描述](https://doc.shiyanlou.com/courses/1541/1207281/2c67d44eb928c0620a4be01388cfb654)

**在PostgreSQL实例中创建sample数据库：** 

bin/sdb_sql_ctl createdb sample myinst

操作截图：

![图片描述](https://doc.shiyanlou.com/courses/1541/1207281/0d207aa9e8d43efc007ca3f3c2b74c64)

**进入PostgreSQL shell环境：**

bin/psql -p 5432 -d sample

操作截图：

![图片描述](https://doc.shiyanlou.com/courses/1541/1207281/a09dea0447a478d6b51e86004f5788b8)

**建立PostgreSQL实例与SequoiaDB数据库关联，加载SequoiaDB连接驱动：**

sample=# create extension sdb_fdw;

CREATE EXTENSION

**配置与SequoiaDB的连接参数，创建server**：

sample=# create server sdb_server foreign data wrapper sdb_fdw options(address '127.0.0.1', service '11810', user 'sdbadmin', password 'sdbadmin', preferedinstance 'A', transaction 'on');

CREATE SERVER

**建立与SequoiaDB数据库集合空间和集合的关联关系:**

sample=# create foreign table emp(id int, name char(10)) server sdb_server options ( collectionspace 'sample', collection 'emp', decimal 'on' ) ;

CREATE FOREIGN TABLE

**更新表emp的统计信息，并验证数据访问：**

sample=# analyze emp;
ANALYZE
sample=# select * from emp;

操作截图：

![图片描述](https://doc.shiyanlou.com/courses/1541/1207281/e57babbccaf3c9f74d4075aeae480237)

