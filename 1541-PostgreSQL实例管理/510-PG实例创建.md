安装SequoiaDB-PostgreSQL组件，创建PostgreSQL实例，验证与SequoiaDB数据库的连接与访问

首先，进入PostgreSQL组件安装包所在目录：

cd /home/shiyanlou/sequoiadb-3.4/

修改PostgreSQL组件安装包文件属性，获取root权限：
sudo chmod 777 sequoiasql-postgresql-3.4-x86_64-installer.run

[sudo] sdbadmin 的密码： 

注：sdbadmin密码：sdbadmin

sudo su

安装PostgreSQL组件：
 ./sequoiasql-postgresql-3.4-x86_64-installer.run 

Language Selection

Please select the installation language
[1] English - English
[2] Simplified Chinese - 简体中文

Please choose an option [1]: 2

由BitRock InstallBuilder评估本所建立

欢迎来到 SequoiaSQL PostgreSQL Server 安装程序

----------------------------------------------------------------------------
请指定 SequoiaSQL PostgreSQL Server 将会被安装到的目录

安装目录 [/opt/sequoiasql/postgresql]: 

----------------------------------------------------------------------------
数据库管理用户配置

配置用于启动SequoiaSQL PostgreSQL的用户名、用户组和密码

用户名 [sdbadmin]: 

用户组 [sdbadmin_group]: 

密码 [********] :

确认密码[********] :

设定现在已经准备将 SequoiaSQL PostgreSQL Server 安装到您的电脑.

您确定要继续? [Y/n]: 

----------------------------------------------------------------------------
正在安装 SequoiaSQL PostgreSQL Server 于您的电脑中，请稍候.

 安装中
 0% ______________ 50% ______________ 100%
 #########################################

----------------------------------------------------------------------------
安装程序已经完成安装 SequoiaSQL PostgreSQL Server 于你的电脑中.

检查5432端口是否被占用,  切换回sdbadmin用户：

netstat -nap|grep 5432

exit                      

进入PostgreSQL组件安装目录，创建PostgreSQL实例:

指定实例名为myinst，该实例名映射相应的数据目录和日志路径，用户可以根据自己需要指定不同的实例名

cd /opt/sequoiasql/postgresql/

bin/sdb_sql_ctl addinst myinst -D database/5432/

Adding instance myinst ...

ok

查看PostgreSQL实例：

bin/sdb_sql_ctl listinst

NAME       PGDATA                                   PGLOG                                   
myinst     /opt/sequoiasql/postgresql/database/5432/ /opt/sequoiasql/postgresql/myinst.log   
Total: 1

启动PostgreSQL实例：

bin/sdb_sql_ctl start myinst

Starting instance myinst ...
ok (PID: 30695)

查看PostgreSQL实例状态：

bin/sdb_sql_ctl status

INSTANCE   PID        SVCNAME    PGDATA                                   PGLOG                                   
myinst     30695      5432       /opt/sequoiasql/postgresql/database/5432/ /opt/sequoiasql/postgresql/myinst.log   
Total: 1; Run: 1

建立PostgreSQL实例与SequoiaDB数据库的关联，首先，启动SequoiaDB数据库：

sdbstart -t all

Success: sequoiadb(11800) is already started (64)
Success: sequoiadb(11840) is already started (243)
Success: sequoiadb(11820) is already started (149)
Success: sequoiadb(11810) is already started (109)
Success: sequoiadb(11830) is already started (180)
Total: 5; Succeed: 5; Failed: 0

在SequoiaDB数据库中, 创建集合空间sample和集合emp，插入样例数据：

sdb
Welcome to SequoiaDB shell!
help() for help, Ctrl+c or quit to exit

db = new Sdb()
localhost:11810
Takes 0.023555s.
db.sample.emp.insert({id:1,name:"emp1"})
{
  "InsertedNum": 1,
  "DuplicatedNum": 0
}
Takes 0.042704s.
db.sample.emp.insert({id:2,name:"emp2"})
{
  "InsertedNum": 1,
  "DuplicatedNum": 0
}
Takes 0.003907s.
quit

在PostgreSQL实例中创建sample数据库： 

bin/sdb_sql_ctl createdb sample myinst

Creating database myinst ...
ok

进入PostgreSQL shell环境：

bin/psql -p 5432 -d sample

psql (9.3.4)
Type "help" for help.

sample=#

建立PostgreSQL实例与SequoiaDB数据库关联，加载SequoiaDB连接驱动：

sample=# create extension sdb_fdw;

CREATE EXTENSION
sample=# 

配置与SequoiaDB的连接参数，创建server，建立与SequoiaDB数据库集合空间和集合的关联关系：

sample=# create server sdb_server foreign data wrapper sdb_fdw options(address '127.0.0.1', service '11810', user 'sdbadmin', password 'sdbadmin', preferedinstance 'A', transaction 'on');

CREATE SERVER

sample=# create foreign table emp(id int, name char(10)) server sdb_server options ( collectionspace 'sample', collection 'emp', decimal 'on' ) ;

CREATE FOREIGN TABLE

更新表emp的统计信息，并验证数据访问：

sample=# analyze emp;
ANALYZE
sample=# select * from emp;
 id |    name    
----+------------
  1 | emp1      
  2 | emp2      
(2 rows)

sample-# \q

