**PostgreSQL实例数据导入导出**

**课程介绍**

如何在PostgreSQL中导出/导入SequoiaDB中的数据

**进入PostgreSQL shell环境：**

cd /opt/sequoiasql/postgresql

psql -d sample

psql (9.3.4)
Type "help" for help.

sample=# 

**通过COPY（select...）命令将外部表purchaseorder的数据导出为.csv文件：**

COPY (select * from purchaseorder) TO  './purchaseorder.csv' with delimiter ','  csv;
COPY 6

**查看csv文件内容：**

\! more purchaseorder.csv

注：!前包含反斜线“\”，

操作截图：

![图片描述](https://doc.shiyanlou.com/courses/1541/1207281/2c115e06afb6d6be687da01c92130384)

**退出PostgreSQL Shell：**

\q

**PostgreSQL的COPY FORM命令不支持直接向外部表中导入数据，一旦数据需要恢复，可以用SequoiaDB的导入工具sdbimprt完成向集合的数据导入，演示命令如下：**

sdb
Welcome to SequoiaDB shell!
help() for help, Ctrl+c or quit to exit

db = new Sdb()
localhost:11810
Takes 0.003207s.

**模拟删除purchaseorder数据集合：**

db.sample.dropCL('purchaseorder');
Takes 0.148984s.

**创建新的purchaseorder数据集合，并分别在SequoiaDB和PostgreSQL中验证数据为空：**

db.sample.createCL('purchaseorder')
localhost:11810.sample.purchaseorder
Takes 0.030096s.

db.sample.purchaseorder.find()
Return 0 row(s).
Takes 0.003642s.

quit

psql -d sample
psql (9.3.4)
Type "help" for help.

select * from purchaseorder;
 poid | status | custid | orderdate | porder 
------+--------+--------+-----------+--------
(0 rows)

\q

**通过sdbimprt工具从备份文件中恢复数据到purchaseorder数据集合中：**

sdbimprt --hosts=localhost:11810 --type=csv --file=/opt/sequoiasql/postgresql/purchaseorder.csv --fields="poid int , status string , custid int , orderdate date , porder string" --datefmt "YYYY-MM-DD" -c sample -l purchaseorder

操作截图：

![图片描述](https://doc.shiyanlou.com/courses/1541/1207281/7eacfa26fdb900a41d53d4e0e7f25a93)

**PostgreSQL shell中验证数据访问：**

psql -d sample
psql (9.3.4)
Type "help" for help.

sample=# select * from purchaseorder;

操作截图：

![图片描述](https://doc.shiyanlou.com/courses/1541/1207281/93b3d64f1a19c203f018a396946d542f)

**退出PostgreSQL Shell：**

\q

