# 考试

## 挑战PG实例的日常管理

#### 知识点

1) pg数据库实例使用
2) pg实例的事务操作
3) pg表数据的导出

#### 挑战介绍

在对接好的Sequoiadb和pg的环境下,创建pg实例并进行事务管理操作,pg数据的导入导出

## 挑战内容

1) 创建实例pginst;
2) 创建company_employee表映射到SDB数据库的company.employee集合;
3) 创建事务work,插入company_employee表数据(id:10001, name:'Georgi', age:48),然后执行查询company_employee表,结束事务;
4) 将company_employee表数据导出到/opt/company_employee.csv,使用\! more /opt/company_employee.csv查看数据内容;

## 挑战要求

1) 正确创建Sequoiadb的pg映射表;
2) 学会用pg使用事务;
3) 准确导出pg表数据


## 示例代码

1) 创建pg实例
```
/opt/sequoiasql/postgresql/bin/sdb_sql_ctl addinst pginst -D database/5432/
bin/sdb_sql_ctl start pginst
./bin/sdb_sql_ctl  createdb  test  pginst
./bin/psql   -p 5432  test
```
2) 建立连接
```
CREATE EXTENSION sdb_fdw;
CREATE SERVER sdb_server foreign data wrapper sdb_fdw options(address 'sdbserver1:11810', service '11810', user 'sdbadmin', password 'sdbadmin');
CREATE FOREIGN TABLE company_employee (id int, name text, age int) SERVER sdb_server options ( collectionspace 'company', collection 'employee', decimal 'on' ) ;
```
3) 开始事务
```
BEGIN work;
INSERT INTO company_employee values(10001,'Georgi',48);
SELECT * FROM company_employee;
commit;
```
4) 导出数据
```
COPY (select * from company_employee) TO  '/opt/company_employee.csv' with delimiter ','  csv;
\! more /opt/company_employee.csv
\q
```

