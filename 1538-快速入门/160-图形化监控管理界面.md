---
show: step
version: 1.0
enable_checker: true
---
# 演示如何基于图形界面监控集群情况

#### 课程介绍

本入门教程 介绍整个SequoiaDB 如何通过图形界面监控集群情况

#### 请点击右侧选择使用的实验环境

#### 部署架构：
本课程中 SequoiaDB 巨杉数据库的集群拓扑结构为三分区单副本，其中包括：1个 SequoiaSQL-MySQL 数据库实例节点、1个引擎协调节点，1个编目节点与3个数据节点。

![图片描述](https://doc.shiyanlou.com/courses/1469/1207281/8d88e6faed223a26fcdc66fa2ef8d3c5)

详细了解 SequoiaDB 巨杉数据库系统架构：
* [SequoiaDB 系统架构](http://doc.sequoiadb.com/cn/sequoiadb-cat_id-1519649201-edition_id-0)

#### 实验环境
课程使用的实验环境为 Ubuntu Linux 16.04 64 位版本。SequoiaDB 数据库引擎以及 SequoiaSQL-MySQL 实例均为 3.4 版本。

#### MySQL Shell 操作数据
1) 使用 sdbadmin 用户登录主机

2) 登录 MySQL shell
```
/opt/sequoiasql/mysql/bin/mysql -h 127.0.0.1 -P 3306 -u root
```

3）创建数据库
```
CREATE DATABASE company;
USE company ;
```

4）创建包含自增主键字段的 employee 表
```sql
CREATE TABLE employee (empno INT AUTO_INCREMENT PRIMARY KEY, ename VARCHAR(128), age INT) ;
```

5) 查看数据库 company下的数据表
```
show tables;
```

6) 向 employee 数据表插入数据
```
INSERT INTO employee (ename, age) VALUES ("Jacky", 36) ;
INSERT INTO employee (ename, age) VALUES ("Alice", 18) ;
```

7) 查看 employee 数据表的数据
```sql
select * from employee;
```

8）退出 MySQL Shell
```
\q
```

9) 使用 vi 编写数据查询脚本 query.sh
```
vi query.sh
# 以下是query.sh 脚本的内容
#!/bin/bash
while true
do 
    /opt/sequoiasql/mysql/bin/mysql -h 127.0.0.1 -P 3306 -u root -e "select * from company.employee" 
done
```

10) 按"ESC"键退出编辑模式，依次按":wq"键，退出vi并保存 query.sh 脚本


11) 后台运行 query.sh 脚本
```
nohup sh ./query.sh>/dev/null 2>&1 &
```

#### 连接图形界面
打开桌面浏览器，访问图形界面

#### 查看集群拓扑

1) 点击"监控"界面，打开分布式存储

2) 依次选择"节点"->"分区组列表"界面，查看集群拓扑


#### 查看集群数据情况

1) 点击"数据"界面，点击数据库实例"MySQLInstance"

2) 点击查看company.employee 集合的数据情况

## 查看性能监控界面

1) 依次点击"监控"->"节点"->"图表"界面，可以查看此时集群的更删查改的性能情况

2) kill 掉后台运行脚本
```
ps -ef | grep "query.sh" | grep -v grep | awk '{print $2}' | xargs kill -9 
```

3) 重新查看性能监控界面，各项指标归零

