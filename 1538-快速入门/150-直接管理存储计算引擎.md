---
show: step
version: 1.0
enable_checker: true
---
# 演示管理存储计算引擎

## 课程介绍

本课程介绍如何管理存储计算引擎，包含执行管理操作、运行实例检查、数据增删改查等操作。

#### 请点击右侧选择使用的实验环境

#### 部署架构：
本课程中 SequoiaDB 巨杉数据库的集群拓扑结构为三分区单副本，其中包括：1个 SequoiaSQL-MySQL 数据库实例节点、1个引擎协调节点，1个编目节点与3个数据节点。

![图片描述](https://doc.shiyanlou.com/courses/1469/1207281/8d88e6faed223a26fcdc66fa2ef8d3c5)

详细了解 SequoiaDB 巨杉数据库系统架构：
* [SequoiaDB 系统架构](http://doc.sequoiadb.com/cn/sequoiadb-cat_id-1519649201-edition_id-0)

#### 实验环境
课程使用的实验环境为 Ubuntu Linux 16.04 64 位版本。SequoiaDB 数据库引擎以及 SequoiaSQL-MySQL 实例均为 3.4 版本。

## 切换用户

部署 SequoiaDB 巨杉数据库和 SequoiaSQL-MySQL 实例的操作系统用户为 sdbadmin。

1）切换至 sdbadmin 用户；
```
su - sdbadmin
```
>Note:
>
>用户 sdbadmin 的密码为 sdbadmin

## MySQL 实例准备数据

1）登录 MySQL shell；
```
/opt/sequoiasql/mysql/bin/mysql -h 127.0.0.1 -P 3306 -u root
```

2）创建并切换到 company 数据库；
```sql
CREATE DATABASE company ;
USE company ;
```

3）创建包含自增主键字段的 employee 表；
```sql
CREATE TABLE employee (empno INT AUTO_INCREMENT PRIMARY KEY, ename VARCHAR(128), age INT) ;
```

4）查看数据库 company下的数据表；
```sql
show tables ;
```

5）向 employee 数据表插入数据；
```
INSERT INTO employee (ename, age) VALUES ("Jacky", 36) ;
INSERT INTO employee (ename, age) VALUES ("Alice", 18) ;
```

6）查看 employee 数据表的数据；
```sql
select * from employee ;
```

7）退出 MySQL Shell；
```
\q
```

## 巨杉数据库存储引擎直接操作

1）在 Linux 命令行中进入 SequoiaDB Shell 交互式界面；

```
sdb
```

2）使用 JavaScript 连接协调节点，并获取数据库连接；

```javascript
var db = new Sdb ("localhost",11810) ;
```


3）查看集群有哪些集合；

```javascript
db.list (SDB_LIST_COLLECTIONS) ;
```

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/ecfe4757de8c2c5418cb76eb0aa2e008)

4）查看集合 company.employee 的数据；

```javascript
db.company.employee.find() ;
```

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/7517d899389a11bf900907bc1968966d)

5）更新集合 company.employee中 name 字段值为 "Jacky" 的记录的 age 字段为 35；

```javascript
db.company.employee.update ( { "$set" : { "age" : 35 } } , { "ename" : "Jacky" } ) ;
```

6）关闭 db数据库连接；

```javascript
db.close () ;
```

7）退出 SequoiaDB Shell；

```
quit ;
```

## MySQL查看更新的数据

1）登录 MySQL shell；

```
/opt/sequoiasql/mysql/bin/mysql -h 127.0.0.1 -P 3306 -u root
```

2）查看company.employee数据表的 name 字段值为 "Jacky" 的 "age" 字段值是否更新为 35；

```sql
SELECT * FROM company.employee ;
```

3）退出 MySQL Shell；
```
\q
```

## SequoiaDB Shell 查看集群情况
1）在 Linux 命令行中进入 SequoiaDB Shell 交互式界面；

```
sdb
```

2）使用 JavaScript 连接协调节点，并获取数据库连接；

```javascript
var db = new Sdb ("localhost",11810) ;
```

3）查看 SequoiaDB 集群拓扑结构；
```javascript
db.list (SDB_LIST_GROUPS) ;
``` 

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/d391347a5d499ae39ff3a681f0d3b58c)

4）查看 SequoiaDB 集群节点状态信息；
```javascript
db.snapshot (SDB_SNAP_DATABASE) ;
```

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/0dda8edb8f7247ff2670c65405c2f595)

5）查看 SequoiaDB 集群集合快照信息；
```javascript
db.snapshot (SDB_SNAP_COLLECTIONS) ;
```

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/a7930b44e37f050b8c35a8b9e768b31f)

6）直连端口号为 11830 的数据节点；

```javascript
var data = new Sdb("localhost", 11830) ;
```

7）查看该节点的状态信息；

```javascript
data.snapshot (SDB_SNAP_DATABASE) ;
```

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/282dd1ac68c497f41de71ffe4685c65b)

8）查看该节点下的集合列表信息；

```javascript
data.list (SDB_LIST_COLLECTIONS) ;
```

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/bcc36bf47b54c748878895e6be9733de)

9）查看该节点下的company.employee 集合的数据；

```javascript
data.company.employee.find() ;
```

6）关闭 db数据库连接；

```javascript
db.close () ;
data.close() ;
```

7）退出 SequoiaDB Shell；

```
quit ;
```
## 总结
SequoiaDB 在存储计算引擎均提供接口可以执行管理操作、运行实例检查、数据增删改查等操作。
