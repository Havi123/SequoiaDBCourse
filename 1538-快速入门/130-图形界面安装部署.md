---
show: step
version: 1.0
enable_checker: true
---
# 图形界面安装部署

## 课程介绍

本入门教程介绍如何基于图形界面安装部署巨杉数据库集群以及创建MySQL实例。

## 准备安装介质

解压 SequoiaDB 安装介质 sequoiadb-3.4-linux_x86_64.tar.gz，并给解压得到的 run 包增加可执行权限
```
tar -zxvf sequoiadb-3.4-linux_x86_64.tar.gz 
cd sequoiadb-3.4
chmod u+x sequoiadb-3.4-linux_x86_64-installer.run
chmod u+x sequoiasql-mysql-3.4-linux_x86_64-installer.run
chmod u+x sequoiasql-postgresql-3.4-x86_64-installer.run
chmod u+x setup.sh
```

## 切换用户

安装 SequoiaDB 巨杉数据库需要 root 用户权限

1）命令行输入更新 root 密码命令
```
sudo passwd root
```
2）在 `[sudo] password for shiyanlou:` 后输入当前用户的密码

> Note:
> shiyanlou 用户密码为: shiyanlou

3）当前用户密码验证通过后, 输入需要设置的 root 超级管理员账户密码 `Enter new UNIX password:` 
4）再次输入密码，验证输入的密码 `Retype new UNIX password:`
5）出现 `passwd: password updated successfully` 字样，表示超级管理员 root 账户密码设置成功
6）切换至 root 用户，验证超级管理账户密码是否更新成功，验证通过则成功切换到超级管理员 root 账户
```
su root
```

## 安装 SequoiaDB 数据库

1）运行安装脚本
```
./setup.sh --sdb
```

2）提示选择向导语言，可根据需要输入 1 选择英文，或者输入 2 选择中文
```
Language Selection

Please select the installation language
[1] English - English
[2] Simplified Chinese - 简体中文
Please choose an option [1] : 2
```

3）显示安装协议，输入 1 表示忽略阅读并同意协议，输入 2 表示读取完整协议内容
```
----------------------------------------------------------------------------
由BitRock InstallBuilder评估本所建立

欢迎来到 SequoiaDB Server 安装程序

----------------------------------------------------------------------------
重要信息：请仔细阅读

下面提供了两个许可协议。

1. SequoiaDB 评估程序的最终用户许可协议
2. SequoiaDB 最终用户许可协议

如果被许可方为了生产性使用目的（而不是为了评估、测试、试用“先试后买”或演示）获得本程序，单击下面的“接受”按钮即表示被许可方接受 SequoiaDB 最终用户许可协议，且不作任何修改。

如果被许可方为了评估、测试、试用“先试后买”或演示（统称为“评估”）目的获得本程序：单击下面的“接受”按钮即表示被许可方同时接受（i）SequoiaDB 评估程序的最终用户许可协议（“评估许可”），且不作任何修改；和（ii）SequoiaDB 最终用户程序许可协议（SELA），且不作任何修改。

在被许可方的评估期间将适用“评估许可”。

如果被许可方通过签署采购协议在评估之后选择保留本程序（或者获得附加的本程序副本供评估之后使用），SequoiaDB 评估程序的最终用户许可协议将自动适用。

“评估许可”和 SequoiaDB 最终用户许可协议不能同时有效；两者之间不能互相修改，并且彼此独立。

这两个许可协议中每个协议的完整文本如下。

评估程序的最终用户许可协议



[1] 同意以上协议: 了解更多的协议内容，可以在安装后查看协议文件
[2] 查看详细的协议内容
请选择一个选项 [1] : 1
```

4）指定 SequoiaDB 安装路径，输入完毕后按回车。若没有输入直接回车，将使用默认的安装路径（/opt/sequoiadb）
```
----------------------------------------------------------------------------
请指定 SequoiaDB Server 将会被安装到的目录

安装目录 [/opt/sequoiadb]:
```

5）询问是否强制安装，y 表示强制安装，安装时发现有相关进程存在则会尝试停止进程，N 表示非强制安装，安装时发现有相关进程存在，就会报错退出。默认为非强制安装
```
----------------------------------------------------------------------------
是否强制安装？强制安装时可能会强杀残留进程

是否强制安装 [y/N]: n
```

6）提示配置 Linux 用户名和用户组，输入完毕后按回车。若没有输入直接回车，将会创建默认的用户名（sdbadmin）和用户组（sdbadmin_group）。该用户名用于运行 SequoiaDB 服务
```
----------------------------------------------------------------------------
数据库管理用户配置

配置用于启动SequoiaDB的用户名、用户组和密码

用户名 [sdbadmin]:

用户组 [sdbadmin_group]:
```

7）提示配置刚才创建的 Linux 用户的密码，输入完毕后按回车。若没有输入直接回车，将会使用默认密码（sdbadmin）
```
密码 [********] :
确认密码 [********] :
```

8）提示配置服务端口，输入完毕后按回车。若没有输入直接回车，将使用默认的服务端口号（11790）
```
----------------------------------------------------------------------------
集群管理服务端口配置

配置SequoiaDB集群管理服务端口,集群管理用于远程启动添加和启停数据库节点

集群管理服务端口 [11790]:
```

9）询问是否允许 SequoiaDB 巨杉数据库相关进程开机自启动，Y 表示允许，n 表示不允许。默认为允许
```
----------------------------------------------------------------------------
是否允许Sequoiadb相关进程开机自启动？

Sequoiadb相关进程开机自启动 [Y/n]: y
```

10）询问是否安装 OM 服务，1 表示安装 2 表示不安装，选择安装
```
----------------------------------------------------------------------------
是否安装OM服务

[1] true
[2] false
[3] only
请选择一个选项 [2] : 1
```

11）询问是否继续安装，Y 表示继续，n 表示不继续。默认为继续
```
------------------------------------------------------------
设定现在已经准备将 SequoiaDB Server 安装到您的电脑.
您确定要继续? [Y/n]:
```

12）当屏幕上显示以下信息，表示 SequoiaDB 已经安装完成
```
----------------------------------------------------------------------------
正在安装 SequoiaDB Server 于您的电脑中，请稍候.

 安装中
 0% ______________ 50% ______________ 100%
 #########################################

----------------------------------------------------------------------------
安装程序已经完成安装 SequoiaDB Server 于你的电脑中.
```

## 安装检查

1）检查图形化界面服务是否正在运行，图形化界面默认的监听端口为:8000
```
netstat -nap | grep 8000
```

## 连接图形界面

1）打开浏览器访问 "localhost:8000" 地址，登录用户密码均为 admin
> Note:
> 界面语言请选择中文

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/698df12e32d970f19614ec6a9cfc25b2)

## 安装部署

1）点击 "一键部署"

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/13966618b110e0e510be212635886099)

2）在弹出的部署信息窗口中，填写集群名，用户名、密码，用户组是指在安装 SequoiaDB 软件时创建的Linux 用户，点击 "确定"

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/425687a7df38f8f9c1541449c31c16be)

3）在扫描主机界面，填写集群的IP地址/主机名，root用户的密码，点击"扫描"按钮，旁边的主机列表状态为"连接成功"，表示参数填写正确，点击"下一步"

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/233a8110ce2150d02898ed7424b82486)

4）勾选安装巨杉数据库软件的主机，点击"下一步"

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/0f983eea49038e5c0b0e0cf234774661)

5）等待主机安装巨杉数据库软件成功后，点击"下一步"

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/8d2ee6af971e63fce57a730a5716961d)

6）根据 SequoiaDB 巨杉数据库的集群拓扑结构为三分区单副本，因此部署副本数为 1，分区组数为 3，编目节点和协调节点数为1，点击"下一步"

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/2675f57b405f25a8200e27a465b340c4)

7）点击节点列表的任意节点，配置该节点参数信息，若采用默认配置，则点击"下一步"

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/4dd6c4856862a8cf88d340f90533f358)

8）等待集群部署完毕后，提示是否创建 SQL 实例，选择是

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/c0ee89d7a3caf4e869246a45a97753dc)

9）将 MySQL 实例安装包复制到 SequoiaDB 巨杉数据库安装目录下的 packet 目录
```
mv /home/shiyanlou/sequoiadb-3.4/sequoiasql-mysql-3.4-linux_x86_64-enterprise-installer.run /opt/sequoiadb/packet/
```

10）配置 MySQL 实例安装路径、数据路径，root用户密码等信息，点击"下一步"

操作截图：
![](https://doc.shiyanlou.com/courses/1538/1207281/9e3fb3e32c356bd7bd4622e700552c31)

11）等待 MySQL 实例部署完成

操作截图：
![](https://doc.shiyanlou.com/courses/1538/1207281/beeea62767782f336b0969480b6c0f08)

12）提示是否为实例添加分布式存储，点击"是"

操作截图：
![](https://doc.shiyanlou.com/courses/1538/1207281/ffc51cab4d4290b77c5d5c93ad0e79e1)

13）在弹出的添加实例存储窗口，配置实例连接分布式存储的信息，"高级"标签配置更多参数信息，点击"确定"

操作截图：
![](https://doc.shiyanlou.com/courses/1538/1207281/9389af1ff0d327f21e41208a0e43b43b)

14）添加实例存储成功后，对应实例的界面中存储集群会显示该实例对应的分布式存储

操作截图：
![](https://doc.shiyanlou.com/courses/1538/1207281/b3fa966f739480ec8a04ecdedf3efce9)

## 图形界面数据操作

在图形界面的"数据"界面，提供对实例的图形界面数据增删查改功能

1）点击"数据"界面下的 "MySQLInstance" 实例

操作截图：
![](https://doc.shiyanlou.com/courses/1538/1207281/4de698b338225da834d70e8ed9d93c78)

2）点击"创建数据库"，创建 company 数据库

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/d220895b88d8787a1442b3377e93bc07)

3）点击"创建数据表"，在弹出的窗口中，填写数据表名:"employee",字段结构如下：
```
empno INT PRIMARY KEY
ename VARCHAR(128)
age INT
```
> Note:
> 点击字段结构后的"+"号增加字段

操作截图：
![](https://doc.shiyanlou.com/courses/1538/1207281/c0f8e461bdbe2306b152bca3f9fc96f8)

4） 点击"employee" 表名，在 SQL 语句填写栏逐个填写如下 SQL 语句，点击执行
```sql
INSERT INTO employee (empno,ename, age) VALUES (1,"Jacky", 36)
INSERT INTO employee (empno,ename, age) VALUES (2,"Alice", 18)
```
> Note:
> 
> SQL语句后面不需要添加分号(";")

操作截图：
![](https://doc.shiyanlou.com/courses/1538/1207281/574936f0fbaa802b411ab73567eaf32a)

5）在 SQL 语句填写栏逐个填写如下 SQL 语句，点击执行，查看"employee"表的数据
```sql
SELECT * FROM employee
```

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/22d7dff25ea0cc1ba3db0816302cc3b5)

## 命令行查看数据

1）打开命令行终端，切换到 sdbadmin 用户；
```
su - sdbadmin
```

2）登录 MySQL shell；
```
/opt/sequoiasql/mysql/bin/mysql -h 127.0.0.1 -P 3306 -u root
```

3）查看 company.employee 表的数据；
```sql
USE company ;
SELECT * FROM employee ;
```

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/988ff851515fcdd4bfce18f839100525)

4）退出 MySQL Shell；
```
\q
```

## 总结
本课程主要讲述 SequoiaDB 和 SequoiaSQL-MySQL 实例的图形化界面安装部署，同时也创建了数据库和数据表进行测试。


