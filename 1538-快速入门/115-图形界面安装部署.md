---
show: step
version: 1.0
enable_checker: true
---
# 图形界面安装部署

## 课程介绍

本课程介绍如何基于图形界面安装部署巨杉数据库集群以及创建 MySQL 实例。

#### 请点击右侧选择使用的实验环境

#### 部署架构：
部署完成后 SequoiaDB 巨杉数据库的集群拓扑结构为三分区单副本，其中包括：1个 SequoiaSQL-MySQL 数据库实例节点、1个引擎协调节点，1个编目节点与3个数据节点。

![图片描述](https://doc.shiyanlou.com/courses/1469/1207281/8d88e6faed223a26fcdc66fa2ef8d3c5)

详细了解 SequoiaDB 巨杉数据库系统架构：
* [SequoiaDB 系统架构](http://doc.sequoiadb.com/cn/sequoiadb-cat_id-1519649201-edition_id-0)

#### 实验环境
课程使用的实验环境为 Ubuntu Linux 16.04 64 位版本。SequoiaDB 数据库引擎以及 SequoiaSQL-MySQL 实例均为 3.4 版本。


## 准备安装介质

SequoiaDB 巨杉数据库存储引擎及SequoiaSQL-MySQL 实例安装介质存放在 /home/shiyanlou/Desktop 目录。

1）点击桌面左下方的"Applications", 点击"Terminal Emulator"，启动 Terminal；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/6dd9782fa75719a18544476316f25888-0)


2）切换到 /home/shiyanlou/Desktop 目录；

```
cd /home/shiyanlou/Desktop
```

3）解压安装包；

```shell
tar -zxvf sequoiadb-3.4-linux_x86_64.tar.gz 
```

4）进入解压目录；

```shell
cd sequoiadb-3.4
```

5）run 包增加可执行权限；

```shell
chmod u+x sequoiadb-3.4-linux_x86_64-installer.run
chmod u+x sequoiasql-mysql-3.4-linux_x86_64-installer.run
chmod u+x sequoiasql-postgresql-3.4-x86_64-installer.run
chmod u+x setup.sh
```

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/6c0ca9c5b83fec2c93239a549a12aa35-0)


## 设置 root 用户密码
由于使用界面安装需用root的用户密码，Ubuntu 的 root 账号默认是被禁用的，需要手工开启。

1）开启 root，重新设置密码；
```
sudo passwd root 
```
> Note:
> - 显示`[sudo] password for wheat:`后输入当前用户的密码 `shiyanlou`
。
> - 验证通过显示`Enter new UNIX password:`后输入`shiyanlou` 或其他字符作为密码。
> - 重新确认输入的密码`Retype new UNIX password:`
> - 出现`passwd: password updated successfully`字样，表示超级管理员root账户密码设置成功。

2）查看本机主机名；

```
hostname
```

## 安装 SequoiaDB 数据库

1）运行 SequoiaDB 安装包；
```
sudo ./sequoiadb-3.4-linux_x86_64-installer.run
```

2）提示选择安装语言，点击下拉框，选择"Simplified Chinese - 简体中文"，点击"OK"；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/232b229b83c6c7fd4b53afbc02b8ad38-0)

3）在弹出的设置窗口，点击"前进"；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/b47d6a629de4970ddcccd5f9054cb57d-0)

4）显示安装协议，勾选"我接受此协议"，点击"前进"；

操作截图：
![](https://doc.shiyanlou.com/courses/1538/1207281/c57d878e9f468b8cfcdfd8546890150c-0)

5）指定 SequoiaDB 安装路径，点击"前进"。若选择安装目录，将使用默认的安装路径（/opt/sequoiadb）；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/8d3900ca794d6895511ec64a86185526-0)


6）询问是否强制安装，"是"表示强制安装，安装时发现有相关进程存在则会尝试停止进程，"否"表示非强制安装，安装时发现有相关进程存在，就会报错退出。默认为非强制安装。点击"前进"；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/5a3a642318e6368f35d97ec045d6902d-0)

7）提示用于安装运行数据库服务的 Linux 用户名和用户组以及密码, 输入完毕后点击"前进"。若不修改默认的用户名、用户组以及用户密码，在确认密码栏填写"sdbadmin"，确认用户密码为"sdbadmin"，然后点击"前进"，将会创建默认的用户名（sdbadmin）和用户组（sdbadmin_group），采用默认密码 (sdbadmin)。

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/3687c9e9ac4728733c4f3e40bf7b6e61-0)

8）提示配置服务端口，输入完毕后点击"前进"。若没有输入直接点击"前进"，将使用默认的服务端口号（11790）；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/11ef499f9ca3dfa471a9ef2b1d6acf20-0)


9）询问是否允许 SequoiaDB 巨杉数据库相关进程开机自启动，"是"表示允许，"否"表示不允许。默认为允许，点击"前进"；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/6b6400f174dfb6c8e567633dcf735e46-0)


10）询问是否安装 OM 服务（SequoiaDB管理中心进程，安装后才能使用 SAC 管控中心对数据、集群状态和系统资源等进行图形化页面监控），"true"表示安装 "false"表示不安装, 选择"true"，点击"前进"；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/9ec5d0148f4b927198029e6d740a9d20-0)


11）询问是否继续安装，"前进"表示继续，"取消"表示不继续，"后退"表示返回上一步。点击"前进"；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/68f17c8ad7bbb9a35ed3252f7c939e3f-0)


12）当显示以下界面时，表示 SequoiaDB 已经安装完成，点击"完成"；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/0162f4809ae1f77bb2b53a1ab8b9f0a6-0)


## 安装检查

1）检查图形化界面服务是否正在运行，图形化界面默认的监听端口为:8000；
```
sudo netstat -nap | grep 8000
```


## 连接图形界面

1）点击桌面火狐浏览器图标 "Firefox Web Browser"，打开FireFox 浏览器访问 "localhost:8000" 地址，登录用户密码均为 admin，界面语言请选择中文；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/698df12e32d970f19614ec6a9cfc25b2)

#### 安装部署

1）点击 "一键部署"；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/13966618b110e0e510be212635886099)

2）在弹出的部署信息窗口中，填写集群名，用户名、密码，用户组是指在安装 SequoiaDB 软件时创建的Linux 用户，点击 "确定"；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/425687a7df38f8f9c1541449c31c16be)

3）在扫描主机界面，填写集群的 IP 地址/主机名（本示例填写前面章节执行`hostname`得到的本机主机名），root 用户的密码（填写前面章节设置的 root 密码），点击"扫描"按钮，旁边的主机列表状态为"连接成功"，表示参数填写正确，点击"下一步"；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/233a8110ce2150d02898ed7424b82486)

4）勾选安装巨杉数据库软件的主机，点击"下一步"；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/0f983eea49038e5c0b0e0cf234774661)

5）等待主机安装巨杉数据库软件成功后，点击"下一步"；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/8d2ee6af971e63fce57a730a5716961d)

6）根据 SequoiaDB 巨杉数据库的集群拓扑结构为三分区单副本，因此部署副本数为 1，分区组数为 3，编目节点和协调节点数为1，点击"下一步"；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/2675f57b405f25a8200e27a465b340c4)

7）点击节点列表的任意节点，配置该节点参数信息，若采用默认配置，则点击"下一步"；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/4dd6c4856862a8cf88d340f90533f358)

8）等待集群部署完毕后，提示是否创建 SQL 实例，选择“是”；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/c0ee89d7a3caf4e869246a45a97753dc)

9）将 MySQL 实例安装包复制到 SequoiaDB 巨杉数据库安装目录下的 packet 目录；
```
mv /home/shiyanlou/sequoiadb-3.4/sequoiasql-mysql-3.4-linux_x86_64-enterprise-installer.run /opt/sequoiadb/packet/
```

10）配置 MySQL 实例安装路径、数据路径，root用户密码等信息，点击"下一步"；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/9e3fb3e32c356bd7bd4622e700552c31)

11）等待 MySQL 实例部署完成；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/beeea62767782f336b0969480b6c0f08)

12）提示是否为实例添加分布式存储，点击"是"；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/ffc51cab4d4290b77c5d5c93ad0e79e1)

13）在弹出的添加实例存储窗口，配置实例连接分布式存储的信息，"高级"标签配置更多参数信息，点击"确定"；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/9389af1ff0d327f21e41208a0e43b43b)

14）添加实例存储成功后，对应实例的界面中存储集群会显示该实例对应的分布式存储；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/b3fa966f739480ec8a04ecdedf3efce9)

## 图形界面数据操作

在图形界面的"数据"界面，提供对实例的图形界面数据增删查改功能。

1）点击"数据"界面下的 "MySQLInstance" 实例；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/4de698b338225da834d70e8ed9d93c78)

2）点击"创建数据库"，创建 company 数据库；

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/d220895b88d8787a1442b3377e93bc07)

3）点击"创建数据表"，在弹出的窗口中，填写数据表名:"employee",字段结构如下：
```
empno INT PRIMARY KEY
ename VARCHAR(128)
age INT
```
> Note:
> 点击字段结构后的"+"号增加字段

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/c0f8e461bdbe2306b152bca3f9fc96f8)

4） 点击"employee" 表名，在 SQL 语句填写栏逐个填写如下 SQL 语句，点击执行
```sql
INSERT INTO employee (empno,ename, age) VALUES (1,"Jacky", 36)
INSERT INTO employee (empno,ename, age) VALUES (2,"Alice", 18)
```
> Note:
> 
> SQL语句后面不需要添加分号(";")

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/574936f0fbaa802b411ab73567eaf32a)

5）在 SQL 语句填写栏逐个填写如下 SQL 语句，点击执行，查看"employee"表的数据；
```sql
SELECT * FROM employee
```

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/22d7dff25ea0cc1ba3db0816302cc3b5)

## 命令行查看数据

1）点击右侧工具栏的"切换界面"，选择字符界面；

2）切换至 sdbadmin 用户；

```
su - sdbadmin
```
> Note:
>
> sdbadmin 用户的密码为 sdbadmin

3）登录 MySQL shell；
```
/opt/sequoiasql/mysql/bin/mysql -h 127.0.0.1 -P 3306 -u root
```

4）查看 company.employee 表的数据；
```sql
SELECT * FROM company.employee ;
```

操作截图：

![](https://doc.shiyanlou.com/courses/1538/1207281/988ff851515fcdd4bfce18f839100525)

5）退出 MySQL Shell；
```
\q
```
## 在数据引擎查询数据
上一小节在 SequoiaSQL-MySQL 实例中创建的表将会默认使用 SequoiaDB 数据库存储引擎，现在直接在数据引擎查询数据。

1）在 Linux 命令行中进入 SequoiaDB Shell 交互式界面；

```
sdb
```

2）使用 JavaScript 连接协调节点，并获取数据库连接；

```javascript
var db = new Sdb ("localhost",11810) ;
```

3）使用 find() 方法从集合中查询数据记录；

```javascript
db.company.employee.find ({ ename: "Abe" }) ;
```

4）关闭数据库 db 连接；

```javascript
db.close () ;
```

5）退出 SequoiaDB Shell；

```
quit ;
```

## 总结
本课程主要讲述 SequoiaDB 和 SequoiaSQL-MySQL 实例的图形化界面安装部署，同时也创建了数据库和数据表进行测试。
