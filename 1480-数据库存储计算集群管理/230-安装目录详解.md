---
show: step
version: 1.0 
---

# 安装目录详解

## 课程介绍

本课程存储集群和数据库实例的安装目录及其子目录下的各个主要文件的内容。

#### 请点击右侧选择使用的实验环境

#### 部署架构：
本课程中 SequoiaDB 巨杉数据库的集群拓扑结构为三分区单副本，其中包括：1个 SequoiaSQL-MySQL 数据库实例节点、1个引擎协调节点，1个编目节点与3个数据节点。

![图片描述](https://doc.shiyanlou.com/courses/1469/1207281/8d88e6faed223a26fcdc66fa2ef8d3c5)

详细了解 SequoiaDB 巨杉数据库系统架构：
* [SequoiaDB 系统架构](http://doc.sequoiadb.com/cn/sequoiadb-cat_id-1519649201-edition_id-0)

#### 实验环境
课程使用的实验环境为 Ubuntu Linux 16.04 64 位版本。SequoiaDB 数据库引擎以及 SequoiaSQL-MySQL 实例均为 3.4 版本。


## 检查集群以及数据库实例是否已启动
```
su - sdbadmin
sdblist -l -m local
/opt/sequoiasql/mysql/bin/sdb_sql_ctl listinst
/opt/sequoiasql/postgresql/bin/sdb_sql_ctl listinst
```

操作截图：
![检查集群以及数据库实例是否已启动](https://doc.shiyanlou.com/courses/1480/1207281/43fa875113512dce1537a215042f7c38)

## 查看sdb安装目录及其子目录下的各个文件
1) 连接mysql，创建一个database和表，插入一些记录
```
su - sdbadmin
/opt/sequoiasql/mysql/bin/mysql -h 127.0.0.1 -P 3306 -u root
create database testdb;
use testdb;
create table test1(id int);
create unique index i_id on test1 (id); 
insert into test1 values(1);
```

操作截图：
![初始化3条记录](https://doc.shiyanlou.com/courses/1480/1207281/761ab87e0cc040e46b768eaf6a6d089a)

2) 创建一个小文件并上传
```
quit;
echo 'aaa' > /tmp/1.txt
sdb
db = new Sdb
db.createCS("foo")
db.foo.createCL("bar")
db.foo.bar.putLob('/tmp/1.txt')
```

操作截图：
![上传一个文件](https://doc.shiyanlou.com/courses/1480/1207281/8736e149874126bab578f8e55e0b8d37)

3) 查看sdb安装目录及其子目录下的各个文件
```
quit
cd /opt/sequoiadb/
ls
ls conf/local
ls conf/local/11810
ls hadoop/
ls spark/
ls python/
ls plugins/
ls tools/
ls tools/dr_ha/
ls database
ls database/data/
ls database/data/11830/
```

操作截图：
![sdb安装目录说明](https://doc.shiyanlou.com/courses/1480/1207281/49cac07142c2f7be41cec91783439189)

sdb的安装目录是/opt/sequoiadb
conf/local目录下存放节点配置信息，例如conf/local/11810下有个sdb.conf，里面存放节点11810的配置信息
hadoop和spark这两个目录下是使用sparkSQL用到的jar包
python目录下是使用python的驱动包
plugins目录下是使用到的插件
tools目录下是工具，例如tools/dr_ha目录下是集群分割和合并的工具
database目录下存放节点数据，有三个子目录：cata对应编目节点，coord对应协调节点，data对应数据节点。每个子目录里面都有一些文件夹，archivelog对应归档日志，diaglog对应诊断信息，bakfile是默认的备份文件存放路径，replicalog存放同步日志。testdb.1.data和testdb.1.idx存放上一步创建的testdb库的数据和索引信息，foo.1.data，foo.1.idx，foo.1.lobd对应集合空间foo的数据，索引，以及lob信息（因为上一步往该集合空间中上传了一个文件）。



## 查看MYSQL安装目录及其子目录下的各个文件
```
ls /opt/sequoiasql/mysql/
ls /opt/sequoiasql/mysql/bin/
ls /opt/sequoiasql/mysql/tools/
ls /opt/sequoiasql/mysql/share/
```
操作截图：
![mysql安装目录详解](https://doc.shiyanlou.com/courses/1480/1207281/fa4388d1e703c008dc71797c35073751)

mysql的安装路径是/opt/sequoiasql/mysql/
bin子目录下是关于mysql的可执行文件
tools子目录下是关于mysql的工具，例如实例同步工具
share子目录下是一些常用的SQL文件以及语言包

## 查看PG安装目录及其子目录下的各个文件
```
ls /opt/sequoiasql/postgresql
ls /opt/sequoiasql/postgresql/conf
ls /opt/sequoiasql/postgresql/share/
ls /opt/sequoiasql/postgresql/conf/instance/myinst.conf
more /opt/sequoiasql/postgresql/conf/instance/myinst.conf
```

操作截图：
![postgre安装目录详解](https://doc.shiyanlou.com/courses/1480/1207281/f7fc021085680aaceb419845d0c13625)

postgresql的安装路径是/opt/sequoiasql/postgresql/
bin子目录下是关于postgresql的可执行文件
share子目录下是一些常用的SQL文件
conf子目录下是一些配置信息，例如conf/instance/myinst.conf里面记录了PGDATA和PGLOG的存放路径


## 删除集合空间并退出
```
sdb
db = new Sdb
db.dropCS("foo")
quit
/opt/sequoiasql/mysql/bin/mysql -h 127.0.0.1 -P 3306 -u root
drop database testdb;
quit
```

操作截图：
![退出安装目录详解](https://doc.shiyanlou.com/courses/1480/1207281/6fdbcc910fa3a8b40af109c6dbff52a6)


## 总结

Sequoiadb是一个分布式数据库，可以存储海量的结构化和非结构化数据，并提供多种接口实例，以方便应用程序的访问。本课程简单介绍了存储集群和数据库实例的安装目录及其子目录下的各个主要文件的内容。

