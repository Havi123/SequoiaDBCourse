# 考试1-弹性扩展和读写一致性

## 挑战介绍

高速运转的大数据时代中,大量高速运转的数据对分布式数据库的存储要求可谓是寄予厚望,已不再只是以往单纯的存储使用

#### 知识点

1）读写强弱一致性

2）多维分区规划

3）日志分析

## 挑战内容

1）创建集合空间 company，创建 ReplSize 为 -1 的强一致集合 employee，以及 ReplSize 为 1 的弱一致性集合 employee2；

2）删除集合空间 company；

3）创建域 mydomain，其中域包含有 group1，group2，group3；

4）创建集合空间 company，存放于 mydomain 域中；

5）在 company 集合空间中创建以字段 tx_date 分区的主表 employee；

6) 创建集合空间 company_2020,存放于 mydomain 域中；

7）在 company_2020 集合空间中创建子表 employee_01 和 employee_02,并关联主表;

8）插入数据(id:10001, tx_date:"2020-02-22")，(id:10002, tx_date:"2020-01-11")，(id:10003, tx_date:"2020-01-13")；

9）用 snapshot 查看 company.employee 的集合快照信息；

10）查看集群中所有协调节点和数据节点的日志路径；

## 挑战要求

1）正确创建集合以及修改其属性

2) 多维分区主子表正常使用

3) 用 Snapshot 查看表信息
 
## 示例代码


1）读写强弱一致性
```shell
sdb 'db.company.createCL("employee", {ReplSize:1})'
sdb 'db.company.createCL("employee2", {ReplSize:1})'
```

2）多维分区规划
```shell
sdb 'db.createDomain('mydomain', ['group1', 'group2', 'group3'])'

sdb 'db.createCS("company", {Domain: "mydomain"})'

sdb 'db.company.createCL('employee', {IsMainCL:true, ShardingKey:{'tx_date':1}, ShardingType:'range' })'

sdb 'db.createCS("company_2020", {Domain:"mydomain"})'

sdb 'db.company_2020.createCL('employee_01', {{ShardingKey:{"tx_date":1}, ShardingType:"hash", Partition:4096, Compressed:true, AutoSplit:true})'

sdb 'db.company_2020.createCL('employee_02', {{ShardingKey:{"tx_date":1}, ShardingType:"hash", Partition:4096, Compressed:true, AutoSplit:true})'

sdb 'db.company.employee.attachCL('company_2020.employee_01', {LowBound:{'tx_date':'2020-01-01'}, UpBound:{tx_date::'2020-02-01'}})'

sdb 'db.company.employee.attachCL('company_2020.employee_02', {LowBound:{'tx_date':'2020-02-01'}, UpBound:{tx_date:'2020-03-01'}})'

sdb 'db.company.employee.insert([{id:10001, tx_date:"2020-02-22"}, {id:10002, tx_date:"2020-01-11"}, {id:10003, tx_date:"2020-01-13"}])'

sdb 'db.company_2020.employee_01.find()'

sdb 'db.company_2020.employee_02.find()'
```
3）性能监控
```shell
sdb 'db.snapshot(4, {Name:"company.employee"})'
```
4）日志路径
```shell
sdb 'db.snapshot(13)'
```

