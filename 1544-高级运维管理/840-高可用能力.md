---
show: step
version: 1.0
enable_checker: true
---

# 数据库高可用

## 课程介绍

本课程主要介绍巨杉数据库的高可用能力。在一个三副本的高可用集群环境中，当一个数据节点出现故障后，整个集群依然能对外提供服务。

**请点击右侧选择使用的实验环境**

**部署架构**

本课程中的SequoiaDB巨杉数据库的集群拓扑结构为三分区三副本。并已部署MySQL实例。

**实验环境**

课程使用的实验环境为Ubuntu Linux 16.04 64位版本。

## 查看数据库状态

`sdblist  -t all -l -m local`

**操作截图：**

 ![840-1png](https://doc.shiyanlou.com/courses/1544/1207281/0f4faf8779944619549bd44d009eee9e)

## MySQL实例创建表并插入数据

**1）登录MySQL实例**

`mysql -uroot -h127.0.0.1`

**2）创建数据库**

```
create database company;
use company;
```

**3）创建表并插入数据**

```
create table T_TEST(id int,name varchar(20),location varchar(20));
insert into T_TEST(id,name,location)values(1,'LEE','SHANGHAI');
```

此时数据库能查询到一条记录

`select * from T_TEST;`

 ![840-3](https://doc.shiyanlou.com/courses/1544/1207281/c05ee769a786fc8d4b042857867d0fb9)



## 关闭巨杉数据库节点服务

关闭每组数据节点中的一个数据节点，来模式数据发生故障。

**1）关闭数据节点**

`sdbstop -p 21820,21830,21840`  

数据库总共有三个数据组（三个数据组分别是group1，group2，group3），每个数据组关闭一个数据节点，因此总共关闭了三个数据节点。

**2）查看数据库状态**

`sdblist -t all -l -m local`

**数据库的状态如下图：**

 ![840-4](https://doc.shiyanlou.com/courses/1544/1207281/5c403ffa5f9117e65ef798e9ec0f18b1)



## 验证数据库功能

#### 登录MySQL验证

**1）登录MySQL实例**

```
mysql -uroot -h127.0.0.1
```

**2）数据插入验证**

```
use company;
insert into employee(name,location)values('STONE','BEIJING');
```

**3）数据查询验证**

```
select * from employee;
```







