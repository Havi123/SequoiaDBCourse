---
show: step
version: 1.0
enable_checker: true
---

# 数据库弹性扩展能力

## 课程介绍

本课程主要介绍Sequoiadb巨杉数据库的弹性扩展能力。同时受限于实验环境，数据库节点均在同一台服务器上演示，扩展步骤和原理与在多台服务器上原理保持一致。

**请点击右侧选择使用的实验环境**

**部署架构**

本课程中的SequoiaDB巨杉数据库的集群拓扑结构为三分区单副本。

**实验环境**

课程使用的实验环境为Ubuntu Linux 16.04 64位版本。

## 切换用户及查看数据库信息

#### 切换到sdbadmin用户

部署 SequoiaDB 巨杉数据库和 SequoiaSQL-MySQL 实例的操作系统用户为 sdbadmin。

```
su - sdbadmin
```

> Note:
>
> 用户 sdbadmin 的密码为 sdbadmin

#### 查看数据库状态

`sdblist  -t all -l -m local`

操作截图：

 ![810-1](https://doc.shiyanlou.com/courses/1544/1207281/633fd3b43d1a5641f89dcbdd711aae30)

## 数据库扩展

本次实验所有扩展均在一台服务器上完成，多服务器扩展原理与此相同。

#### 新增编目节点

**1）连接数据库**

`db=new Sdb()`

**2）获取现有编目节点信息**
`cataRG = db.getRG("SYSCatalogGroup")`

"SYSCatalogGroup"为现有编目节点的名字。

**3）增加新的编目节点**
`node=cataRG.createNode("sdbserver1",11900,"/opt/sequoiadb/database/cata/11900/")`

createNode需要输入三个参数：

第一个参数为服务器的hostname,本机为sdbserver1

第二个参数为新增编目节点的端口号，这里需要一个未被使用的端口号

第三个参数为编目节点相关文件的保存路径

**4）启动新增编目节点**

`node.start()`

**操作截图：**

 ![810-2](https://doc.shiyanlou.com/courses/1544/1207281/15b56215265e76561c0331cb507adcc7)

#### 新增数据节点

**1）新增数据节点信息**

`dataRG = db.createRG("group4")`

**2）添加数据节点的信息**
`dataRG.createNode("sdbserver1", 11850,"/opt/sequoiadb/database/data/11850/")`
createNode需要输入三个参数：

第一个参数为服务器的hostname,本机为sdbserver1

第二个参数为新增编目节点的端口号，这里需要一个未被使用的端口号

第三个参数为编目节点相关文件的保存路径


**3）启动新增数据节点**
`dataRG.start()`

**操作截图：**

 ![810-4](https://doc.shiyanlou.com/courses/1544/1207281/b431fc2ff079a7db851096268e3bd40c)

**查看数据库扩展后状态**

 ![810-5](https://doc.shiyanlou.com/courses/1544/1207281/5ad9b922385ea36fd732e160e5b1353e)

此时新增的编目节点和数据节点已经加入集群。

> Note:
>
> 如果是在新服务器上进行扩容，新增服务器的hostname和ip地址需要添加到所有服务器的/etc/hostname文件中。







