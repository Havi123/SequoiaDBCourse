# 考试
SequoiaDB 是一个分布式数据库，可以存储海量的结构化和非结构化数据，并提供多种接口实例，以方便应用程序的访问。在本课程中简单的介绍了多种实例的安装配置及数据操作过程。是实际应用中，可以根据应用程序的需要安装配置相应的接口实例，并可以实现数据的多实例共享。

## 挑战介绍

用户可以在 SequoiaDB 巨杉数据库中创建多种类型的数据库实例，以满足上层不同应用程序各自的需求。

SequoiaDB 巨杉数据库支持 MySQL、PostgreSQL 与 SparkSQL 三种关系型数据库实例、类 MongoDB 的 JSON 文档类数据库实例、以及 S3 对象存储与 Posix 文件系统的非结构化数据实例。

通过实例操作能对数据库操作过程有清晰的认知。

#### 知识点

 MySQL,PostgreSQL,SparkSQL,S3,FS实例的创建以及使用过程。

## 挑战内容

1) 创建一个 MySQL 实例 myinst；

2) 创建一个 PostgreSQL 实例 pginst；

3) 创建一个 SparkSQL 实例；

4) 在 MySQL 创建数据库名为 company，表名为 employee，并插入数据 (id:10001, name:'Georgi', age:48)，然后查询是否存在数据；

5) 在 PostgreSQL 创建数据库名为 company，表名为 employee，然后查询是否存在数据；

6) 根据 hive-site 内容为 Spark 配置 MySQL 元数据信息；

7) 在 Spark 创建数据库名为 company，表名为 employee，然后查询是否存在数据；


## 示例代码

1) MySQL 实例；

```
cd /opt/sequoiasql/mysql
bin/sdb_sql_ctl addinst myinst -D database/3306/
bin/sdb_sql_ctl start myinst
bin/mysql  -h 127.0.0.1 -P 3306 -u root 
    CREATE DATABASE company ;
    USE company ;
    CREATE TABLE employee (id INT , name VARCHAR(128), age INT) ;
	INSERT INTO employee (id, name, age) VALUES (10001,"Georgi",48) ;
	select * from employee ;
    \q
```
2) PostgreSQL 实例；

```
cd /opt/sequoiasql/postgresql
bin/sdb_sql_ctl addinst pginst -D database/5432/
bin/sdb_sql_ctl start pginst
bin/sdb_sql_ctl createdb company pginst
bin/psql -p 5432 company
    create extension sdb_fdw;
    create server sdb_server foreign data wrapper sdb_fdw options(address 'sdbserver1:11810', service '11810', user 'sdbadmin', password 'sdbadmin');
    CREATE FOREIGN TABLE employee (id INTEGER, name TEXT,age INTEGER) SERVER sdb_server OPTIONS (collectionspace 'company', collection 'employee', decimal 'on') ;
	SELECT * FROM employee ;
```

3) 配置元数据

```
cd /opt/sequoiasql/mysql/bin
mysql -h 127.0.0.1 -P 3306 -u root
    CREATE USER 'metastore'@'%' IDENTIFIED BY 'metastore';
    GRANT ALL ON *.* TO 'metastore'@'%';
    FLUSH PRIVILEGES;
    \q
cd /opt/sequoiasql/mysql/bin
mysql -h 127.0.0.1 -P 3306 -u metastore -p
    DROP DATABASE IF EXISTS metastore;
    CREATE DATABASE metastore CHARACTER SET 'latin1' COLLATE 'latin1_bin';
    \q
```

3) SparkSQL 实例；
```
/opt/spark/sbin/start-all.sh
/opt/spark/sbin/start-thriftserver.sh --master "spark://`hostname`:7077"  --total-executor-cores 2 --executor-memory 1g
bin/beeline -u "jdbc:hive2://`hostname`:10000"
    CREATE DATABASE company;
    CREATE TABLE company.employee(id INT, name STRING,age INT) USING com.sequoiadb.spark OPTIONS ( host 'localhost:11810' ,    collectionspace 'company', collection 'employee', username '',password '') ;
    select * from company.employee ;
```





